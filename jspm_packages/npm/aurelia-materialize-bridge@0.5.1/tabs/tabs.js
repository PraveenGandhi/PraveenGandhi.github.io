/* */ 
define(['exports', 'aurelia-templating', 'aurelia-dependency-injection', 'aurelia-task-queue', '../common/events', '../common/attributeManager'], function (exports, _aureliaTemplating, _aureliaDependencyInjection, _aureliaTaskQueue, _events, _attributeManager) {
  'use strict';

  Object.defineProperty(exports, "__esModule", {
    value: true
  });
  exports.MdTabs = undefined;

  function _classCallCheck(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
      throw new TypeError("Cannot call a class as a function");
    }
  }

  var _createClass = function () {
    function defineProperties(target, props) {
      for (var i = 0; i < props.length; i++) {
        var descriptor = props[i];
        descriptor.enumerable = descriptor.enumerable || false;
        descriptor.configurable = true;
        if ("value" in descriptor) descriptor.writable = true;
        Object.defineProperty(target, descriptor.key, descriptor);
      }
    }

    return function (Constructor, protoProps, staticProps) {
      if (protoProps) defineProperties(Constructor.prototype, protoProps);
      if (staticProps) defineProperties(Constructor, staticProps);
      return Constructor;
    };
  }();

  var _dec, _dec2, _class;

  var MdTabs = exports.MdTabs = (_dec = (0, _aureliaTemplating.customAttribute)('md-tabs'), _dec2 = (0, _aureliaDependencyInjection.inject)(Element, _aureliaTaskQueue.TaskQueue), _dec(_class = _dec2(_class = function () {
    function MdTabs(element, taskQueue) {
      _classCallCheck(this, MdTabs);

      this.element = element;
      this.taskQueue = taskQueue;
      this.fireTabSelectedEvent = this.fireTabSelectedEvent.bind(this);
      this.attributeManager = new _attributeManager.AttributeManager(this.element);
      this.tabAttributeManagers = [];
    }

    MdTabs.prototype.attached = function attached() {
      var _this = this;

      this.attributeManager.addClasses('tabs');

      var children = this.element.querySelectorAll('li');
      [].forEach.call(children, function (child) {
        var setter = new _attributeManager.AttributeManager(child);
        setter.addClasses(['tab', 'primary-text']);
        _this.tabAttributeManagers.push(setter);
      });

      $(this.element).tabs();
      var childAnchors = this.element.querySelectorAll('li a');
      [].forEach.call(childAnchors, function (a) {
        a.addEventListener('click', _this.fireTabSelectedEvent);
      });
    };

    MdTabs.prototype.detached = function detached() {
      var _this2 = this;

      this.attributeManager.removeClasses('tabs');

      this.tabAttributeManagers.forEach(function (setter) {
        setter.removeClasses('tab');
      });
      this.tabAttributeManagers = [];
      var childAnchors = this.element.querySelectorAll('li a');
      [].forEach.call(childAnchors, function (a) {
        a.removeEventListener('click', _this2.fireTabSelectedEvent);
      });
    };

    MdTabs.prototype.fireTabSelectedEvent = function fireTabSelectedEvent(e) {
      var href = e.target.getAttribute('href');
      (0, _events.fireMaterializeEvent)(this.element, 'selected', href);
    };

    MdTabs.prototype.selectTab = function selectTab(id) {
      $(this.element).tabs('select_tab', id);
      this.fireTabSelectedEvent({
        target: { getAttribute: function getAttribute() {
            return '#' + id;
          } }
      });
    };

    _createClass(MdTabs, [{
      key: 'selectedTab',
      get: function get() {
        var children = this.element.querySelectorAll('li.tab a');
        var index = -1;
        var href = null;
        [].forEach.call(children, function (a, i) {
          if (a.classList.contains('active')) {
            index = i;
            href = a.href;
            return;
          }
        });
        return { href: href, index: index };
      }
    }]);

    return MdTabs;
  }()) || _class) || _class);
});